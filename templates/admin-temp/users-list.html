{% extends 'admin-temp/base.html' %}
{% block content %}


    
<div class="card-body"> 
    <div class="table-responsive">
        <div class="table-responsive" id="block-container">
            <table class="table align-middle table-nowrap mb-0" id="userTable">
                <thead class="table-light">
                    <tr>
                        
                        <th class="align-middle" scope="col">Name</th>
                        <th class="align-middle" scope="col">Email</th>
                        <th class="align-middle" scope="col">Phone Number</th>
                        <th class="align-middle" scope="col">IS Ative</th>
                        
                        

                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                
                         <td>{{ user.first_name }}</td> 
                        <td>{{ user.email }}</td>
                        <td>
                            {{ user.phone_number }}
                        </td>
                        <td>
                            {{ user.is_active }}
                        </td>
                    
                          
                        {% if not user.is_superuser %}
                                 {% if user.is_blocked %}
                                 <td>
                                    <a href="{% url 'block_user' user.id %}">
                                        <button type="button" class="btn btn-danger mx-2" id='user-blk' data-user-id="{{user.id}}">Unblock</button></a>
                                </td>
                           {% else %}
                            <td>   
                                <a href="{% url 'block_user' user.id %}">
                                    <button type="submit" class="btn btn-dark " id='user-blk' data-user-id="{{user.id}}">Block</button> </a>
  
                            </td>
                            {% endif %}
                            {% endif %}
                        
                    </tr>
                   
                    {% endfor %}
                    
                    
                    
                    
            
                </tbody>
            </table>
        </div>
    </div> <!-- table-responsive end// -->
</div>



    



{% endblock %}


{% block script %}
<script>
    $('#userTable').DataTable({
        paging:true,
        pageLength:5,
        lengthChange:true,
        autoWidth:true,
        searching:true,
        bInfo:true,
        bSort:false,
    })
</script>
<script>
    $(document).on('click', '#user-blk', function(e) {
        e.preventDefault()
        var text = $(this).text()
        var user_id = $(this).data('user-id')
        swal({
            title:'Are You sure',
            text:'Do you want '+ text + ' User',
            buttons:["Cancel",'Sure'],
            icon:'warning',
            dangerMode:true,
        }).then(function(confirmSure){
            if (confirmSure){
                
                $.ajax({
                    url:'/admin_cu/block_user/' + user_id,
                    success:function(response){
                        swal({
                            title:response.title,
                            text:response.text,
                            button:false,
                            timer:4000,
                            icon:'success'
                        }).then(function(){
                            $("#block-container").load(location.href + " #block-container")
                        });
                    }

                })
            }
        }); 
        
    })
</script>



{% endblock script %}
